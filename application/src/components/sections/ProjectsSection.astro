---
import SectionHeader from '../ui/SectionHeader.astro';
import ProjectCard from '../ui/ProjectCard.astro';
import type { LocaleCopy } from '../../../i18n.config';
import type { FeaturedProjectCard } from '../../lib/constants';

interface Props {
	experience: LocaleCopy['experience'];
	projects: FeaturedProjectCard[];
	ctaHref: string;
}

const { experience, projects, ctaHref } = Astro.props;
const formatSequenceNumber = (index: number) => String(index + 1).padStart(2, '0');
---

<section id="projects" data-scroll-section="#projects" class="relative py-16 sm:py-32 bg-brand-primary scroll-mt-24 sm:scroll-mt-32 overflow-hidden">
	<div class="project-parallax-decor" aria-hidden="true">
		<div class="project-parallax-decor__grid" data-parallax-speed="0.2"></div>
		<div class="project-parallax-decor__beam project-parallax-decor__beam--one" data-parallax-speed="0.35"></div>
		<div class="project-parallax-decor__beam project-parallax-decor__beam--two" data-parallax-speed="0.55"></div>
		<div class="project-parallax-decor__orb project-parallax-decor__orb--left" data-parallax-speed="0.65"></div>
		<div class="project-parallax-decor__orb project-parallax-decor__orb--right" data-parallax-speed="0.45"></div>
	</div>

	<div class="project-parallax-rail" aria-hidden="true">
		<div class="project-parallax-rail__line" data-parallax-speed="0.25"></div>
		<div class="project-parallax-rail__glow" data-parallax-speed="0.4"></div>
	</div>

	<div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6">
		<div class="project-lede" data-animate="fade-up">
			<div class="project-lede__title">
				<SectionHeader title={experience.title} />
			</div>
			<div class="project-lede__body">
				<p>
					{experience.description}
				</p>
			</div>
		</div>

		<div class="project-parallax-grid">
			{projects.map((project, index) => (
				<div 
					class={`project-card-wrapper ${index % 2 === 1 ? 'project-card-wrapper--offset' : ''}`}
					data-animate="slide-up"
					data-animate-delay={String(index * 0.05)}
				>
					<span class="project-card-seq" aria-hidden="true">
						{formatSequenceNumber(index)}
					</span>
					<ProjectCard 
						name={project.name}
						role={project.role}
						description={project.description}
						tags={project.tags}
						highlights={project.highlights}
						url={project.url}
						entity={project.entity}
						timeframe={project.timeframe}
						index={index}
						flipHint={experience.flipHint}
						backLabel={experience.backLabel}
						openLabel={experience.openLabel}
						scopeLabel={experience.scopeLabel}
						highlightsLabel={experience.highlightsLabel}
					/>
				</div>
			))}
		</div>

		<div class="project-cta" data-animate="fade-up">
			<a 
				href={ctaHref}
				target="_blank"
				rel="noopener noreferrer"
				class="inline-flex items-center gap-2 text-brand-secondary hover:text-brand-secondary-soft font-bold text-lg transition-colors group"
			>
				<span>{experience.cta}</span>
				<svg class="w-6 h-6 transform group-hover:translate-x-2 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
				</svg>
			</a>
		</div>
	</div>
</section>
