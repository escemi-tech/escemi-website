---
import Layout from '../../layouts/Layout.astro';
import type { Locale } from '../../../i18n.config';
import { getCopyForLocale } from '../../../i18n.config';
import HeroBackground from '../ui/HeroBackground.astro';
import PrimaryButton from '../ui/PrimaryButton.astro';
import ServiceCard from '../ui/ServiceCard.astro';
import MetricCard from '../ui/MetricCard.astro';
import ProjectCard from '../ui/ProjectCard.astro';
import SectionHeader from '../ui/SectionHeader.astro';
import { EXTERNAL_URLS, CONTACT_BUTTONS, getFeaturedProjectCards } from '../../lib/constants';
import type { ContactButtonIcon } from '../../lib/constants';

interface Props {
locale: Locale;
}

const { locale } = Astro.props;
const copy = getCopyForLocale(locale);
const [firstName, lastName] = copy.hero.name.split(' ');
const projects = getFeaturedProjectCards(locale);
const heroCtaHref = EXTERNAL_URLS.booking ?? EXTERNAL_URLS.linkedin ?? '#';

const BUTTON_ICONS: Record<ContactButtonIcon, { viewBox: string; paths: string[] }> = {
	linkedin: {
		viewBox: '0 0 24 24',
		paths: ['M4 3c-.55 0-1 .45-1 1v16c0 .55.45 1 1 1h16c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H4zm3.2 14H5.3V10h1.9zm-.95-9.1a1.1 1.1 0 111.1-1.1 1.1 1.1 0 01-1.1 1.1zM18.5 17H16.6v-4.3c0-1-.02-2.3-1.4-2.3s-1.6 1.1-1.6 2.2V17h-1.9V10h1.8v1.1h.03c.25-.5.95-1.3 2.3-1.3 2.45 0 2.9 1.6 2.9 3.6z'],
	},
	collective: {
		viewBox: '0 0 24 24',
		paths: [
			'M6 9a2 2 0 110-4 2 2 0 010 4z',
			'M18 9a2 2 0 110-4 2 2 0 010 4z',
			'M12 21a3.5 3.5 0 100-7 3.5 3.5 0 000 7z',
			'M5 21v-2c0-2.2 4.7-3.2 7-3.2s7 1 7 3.2v2H5z',
		],
	},
	malt: {
		viewBox: '0 0 24 24',
		paths: [
			'M12 3l6 4v6l-6 4-6-4V7z',
			'M6 8l12 0',
			'M9 10l0 7',
			'M15 10l0 7',
		],
	},
	github: {
		viewBox: '0 0 24 24',
		paths: [
			'M12 2C6.48 2 2 6.58 2 12.26c0 4.5 2.87 8.31 6.84 9.66.5.1.68-.22.68-.48 0-.24-.01-.87-.01-1.71-2.78.62-3.37-1.37-3.37-1.37-.45-1.18-1.11-1.5-1.11-1.5-.91-.64.07-.63.07-.63 1 .07 1.53 1.06 1.53 1.06.9 1.57 2.36 1.12 2.94.85.09-.68.35-1.12.63-1.38-2.22-.26-4.56-1.14-4.56-5.07 0-1.12.39-2.03 1.03-2.74-.1-.26-.45-1.3.1-2.71 0 0 .84-.28 2.75 1.04A9.29 9.29 0 0112 6.8a9.2 9.2 0 012.5.35c1.9-1.32 2.74-1.04 2.74-1.04.55 1.41.2 2.45.1 2.71.64.71 1.03 1.62 1.03 2.74 0 3.94-2.35 4.81-4.59 5.06.36.32.68.94.68 1.89 0 1.37-.01 2.47-.01 2.81 0 .26.18.58.69.48A10.07 10.07 0 0022 12.26C22 6.58 17.52 2 12 2z',
		],
	},
};
---

<Layout locale={locale} meta={copy.meta}>
<!-- Hero Section -->
<section class="relative min-h-screen flex items-center overflow-hidden bg-gradient-to-b from-brand-primary-strong via-brand-primary to-brand-primary-strong">
<HeroBackground />

<!-- Hero Content -->
<div class="relative z-10 max-w-7xl mx-auto px-6 py-32 w-full">
<div class="max-w-4xl">
<p class="text-lg font-mono text-brand-secondary mb-6 tracking-[0.3em] uppercase animate-glow">
{copy.hero.greeting}
</p>

<div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-10 mb-10">
	<h1 class="text-6xl md:text-8xl lg:text-9xl font-black text-white leading-none tracking-tight">
		<span class="inline-block hover:scale-105 transition-transform duration-300">
			{firstName}
		</span>
		<br />
		<span class="inline-block bg-gradient-to-r from-brand-secondary via-brand-secondary-soft to-brand-secondary bg-clip-text text-transparent animate-gradient bg-size-300 hover:scale-105 transition-transform duration-300">
			{lastName}
		</span>
	</h1>

	{copy.hero.image && (
		<div class="relative w-32 h-32 md:w-40 md:h-40 lg:w-48 lg:h-48 shrink-0">
			<div class="absolute inset-0 rounded-full bg-gradient-to-tr from-brand-secondary/40 to-brand-secondary-soft/20 blur-3xl"></div>
			<div class="relative w-full h-full rounded-full border-2 border-white/30 bg-white/5 backdrop-blur shadow-2xl overflow-hidden">
				<img 
					src={copy.hero.image}
					alt={`${copy.hero.name} portrait`}
					loading="lazy"
					decoding="async"
					class="w-full h-full object-cover"
				/>
				<div class="absolute inset-0 rounded-full border-2 border-brand-secondary/60 animate-border-pulse"></div>
			</div>
		</div>
	)}
</div>

<p class="text-2xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-brand-secondary-soft to-brand-secondary mb-8 tracking-wide">
{copy.hero.title}
</p>

<p class="text-xl md:text-2xl text-gray-300 mb-12 max-w-3xl leading-relaxed font-light">
{copy.hero.baseline}
</p>

{copy.hero.pitch.length > 0 && (
	<div class="space-y-4 text-lg md:text-xl text-gray-200 max-w-4xl mb-12">
		{copy.hero.pitch.map((line) => (
			<p class="leading-relaxed text-gray-200/90">
				{line}
			</p>
		))}
	</div>
)}

<PrimaryButton href={heroCtaHref} text={copy.hero.cta} external={true} />

{copy.hero.signatureNumbers.length > 0 && (
	<div class="mt-16 grid gap-6 sm:grid-cols-2 lg:grid-cols-3 max-w-5xl">
		{copy.hero.signatureNumbers.map((stat, index) => {
			const [value, ...rest] = stat.split(' ');
			const label = rest.join(' ');
			return (
				<div 
					class={`group relative overflow-hidden rounded-3xl border border-white/15 bg-white/5 px-6 py-8 backdrop-blur transition-all duration-300 hover:border-brand-secondary/60 hover:bg-white/10 animate-fade-in-up`}
					style={`animation-delay: ${index * 120}ms;`}
				>
					<div class="absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-r from-brand-secondary/25 via-brand-secondary-soft/20 to-transparent transition-opacity duration-500"></div>
					<div class="pointer-events-none absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent opacity-30 group-hover:opacity-80 animate-stat-shimmer transition-opacity"></div>
					<div class="relative z-10 flex flex-col gap-2 text-left">
						<span class="text-4xl md:text-5xl font-black text-white tracking-tight">
							{value}
						</span>
						<span class="text-sm font-semibold uppercase tracking-[0.3em] text-brand-secondary-soft">
							{label || stat}
						</span>
					</div>
				</div>
			);
		})}
	</div>
)}
</div>
</div>

<!-- Scroll indicator -->
<div class="absolute bottom-10 left-1/2 -translate-x-1/2 z-10 animate-bounce">
<svg class="w-8 h-8 text-brand-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
</svg>
</div>
</section>

<!-- Services Section -->
<section id="expertise" class="relative py-32 bg-brand-primary-strong overflow-hidden scroll-mt-32">
<div class="absolute inset-0 opacity-10">
<div class="absolute top-0 left-0 w-full h-full bg-[linear-gradient(to_right,rgba(236,184,7,0.15)_1px,transparent_1px),linear-gradient(to_bottom,rgba(236,184,7,0.12)_1px,transparent_1px)] bg-[size:4rem_4rem]"></div>
</div>

<div class="relative z-10 max-w-7xl mx-auto px-6">
<SectionHeader title={copy.services.title} />

<div class="grid md:grid-cols-2 gap-6">
{copy.services.items.map((service, index) => (
<ServiceCard 
title={service.title}
description={service.description}
index={index}
isLarge={index === 0}
/>
))}
</div>
</div>
</section>

<!-- Impact Metrics Section -->
<section class="relative py-32 bg-gradient-to-b from-brand-primary-strong via-brand-primary to-brand-primary-strong overflow-hidden">
<div class="absolute inset-0">
<div class="absolute top-1/4 left-1/4 w-96 h-96 bg-brand-secondary/15 rounded-full blur-3xl animate-pulse-slow"></div>
<div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-brand-secondary-soft/15 rounded-full blur-3xl animate-pulse-slow animation-delay-1000"></div>
</div>

<div class="relative z-10 max-w-7xl mx-auto px-6">
<h2 class="text-5xl md:text-7xl font-black text-center text-transparent bg-clip-text bg-gradient-to-r from-brand-secondary to-brand-secondary-soft mb-24 tracking-tight">
{copy.impact.title}
</h2>

<div class="grid md:grid-cols-2 lg:grid-cols-4 gap-12">
{copy.impact.metrics.map((metric, index) => (
<MetricCard 
value={metric.value}
label={metric.label}
description={metric.description}
index={index}
/>
))}
</div>
</div>
</section>

<!-- Projects Section -->
<section id="projects" class="relative py-32 bg-brand-primary scroll-mt-32">
<div class="max-w-7xl mx-auto px-6">
<div class="flex flex-col lg:flex-row lg:items-end lg:justify-between gap-8 mb-16">
	<SectionHeader title={copy.experience.title} />
	<p class="text-base md:text-lg text-gray-200 max-w-2xl">
		{copy.experience.description}
	</p>
</div>

<div class="grid gap-8 lg:grid-cols-2">
{projects.map((project, index) => (
<ProjectCard 
name={project.name}
role={project.role}
description={project.description}
tags={project.tags}
highlights={project.highlights}
url={project.url}
entity={project.entity}
timeframe={project.timeframe}
index={index}
/>
))}
</div>

<div class="mt-16 text-center">
	<a 
		href={EXTERNAL_URLS.linkedin}
		target="_blank"
		rel="noopener noreferrer"
		class="inline-flex items-center gap-2 text-brand-secondary hover:text-brand-secondary-soft font-bold text-lg transition-colors group"
	>
		<span>{copy.experience.cta}</span>
		<svg class="w-6 h-6 transform group-hover:translate-x-2 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
			<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
		</svg>
	</a>
</div>
</div>
</section>

<!-- Contact Section -->
<section id="roles" class="relative py-32 bg-gradient-to-b from-brand-primary via-brand-primary-strong to-brand-primary-strong overflow-hidden scroll-mt-32">
<div class="absolute inset-0 bg-[radial-gradient(ellipse_at_center,rgba(236,184,7,0.15),transparent_55%)]"></div>

<div class="relative z-10 max-w-5xl mx-auto px-6 text-center">
<h2 class="text-5xl md:text-7xl lg:text-8xl font-black text-white mb-8 leading-tight tracking-tight">
{copy.contact.title}
</h2>
<p class="text-xl md:text-2xl text-gray-300 mb-12 max-w-3xl mx-auto leading-relaxed font-light">
{copy.contact.description}
</p>

<div class="mb-16 flex justify-center">
	<PrimaryButton 
		href={EXTERNAL_URLS.booking ?? EXTERNAL_URLS.linkedin ?? '#'}
		text={copy.contact.cta}
		external={Boolean(EXTERNAL_URLS.booking ?? EXTERNAL_URLS.linkedin)}
	/>
</div>

{copy.contact.resumeLinks?.length > 0 && (
	<div class="mb-12 flex flex-wrap items-center justify-center gap-4 text-sm font-semibold uppercase tracking-[0.35em] text-brand-secondary">
		{copy.contact.resumeLinks.map((resumeLink) => (
			<a 
				href={resumeLink.href}
				download
				class="inline-flex items-center gap-3 rounded-full border border-brand-secondary/60 bg-transparent px-6 py-3 text-brand-secondary transition-colors hover:bg-brand-secondary hover:text-brand-primary-strong"
			>
				<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v12m0 0l-4-4m4 4l4-4M5 19h14" />
				</svg>
				<span>{resumeLink.label}</span>
			</a>
		))}
	</div>
)}

{copy.contact.positions?.length > 0 && (
	<div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3 mb-16 text-left">
		{copy.contact.positions.map((position, index) => (
			<div class="relative h-full rounded-3xl border border-white/15 bg-white/5 p-8 backdrop-blur flex flex-col gap-4">
				<span class="text-xs font-semibold uppercase tracking-[0.4em] text-brand-secondary-soft">
					{String(index + 1).padStart(2, '0')}
				</span>
				<h3 class="text-2xl font-black text-white leading-snug">
					{position.title}
				</h3>
				<p class="text-sm text-gray-200/90 leading-relaxed">
					{position.description}
				</p>
			</div>
		))}
	</div>
)}

<div class="flex flex-wrap justify-center gap-6">
{CONTACT_BUTTONS.map((button) => {
	const icon = BUTTON_ICONS[button.icon];
	const isDisabled = !button.url;
	const target = button.url ? '_blank' : undefined;
	const rel = button.url ? 'noopener noreferrer' : undefined;
	const disabledClasses = isDisabled ? 'pointer-events-none opacity-40' : '';

	const iconMarkup = (
		<svg class="w-5 h-5" viewBox={icon.viewBox} fill="currentColor" aria-hidden="true">
			{icon.paths.map((path) => (
				<path d={path}></path>
			))}
		</svg>
	);

	return button.outlined ? (
		<a 
			href={button.url ?? '#'}
			target={target}
			rel={rel}
			aria-disabled={isDisabled}
			class={`px-12 py-6 bg-transparent border-2 border-brand-secondary text-brand-secondary hover:bg-brand-secondary hover:text-brand-primary-strong font-bold text-lg transition-all duration-300 flex items-center justify-center gap-3 ${disabledClasses}`}
		>
			{iconMarkup}
			<span>{button.text}</span>
		</a>
	) : (
		<a 
			href={button.url ?? '#'}
			target={target}
			rel={rel}
			aria-disabled={isDisabled}
			class={`group relative px-12 py-6 bg-gradient-to-r from-brand-secondary to-brand-secondary-soft hover:from-brand-secondary-soft hover:to-brand-secondary text-brand-primary-strong font-bold text-lg transition-all duration-300 shadow-[0_0_35px_rgba(236,184,7,0.35)] hover:shadow-[0_0_55px_rgba(236,184,7,0.45)] overflow-hidden flex items-center justify-center gap-3 ${disabledClasses}`}
		>
			<span class="relative z-10 flex items-center justify-center gap-3">
				{iconMarkup}
				<span>{button.text}</span>
			</span>
			<div class="absolute inset-0 bg-white/20 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300"></div>
		</a>
	);
})}
</div>
</div>
</section>

<!-- Animation Scripts -->
<script>
import { initAnimations } from '../../lib/animations';
initAnimations();
</script>
</Layout>
